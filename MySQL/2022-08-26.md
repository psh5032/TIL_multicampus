# day19

> êµìž¬: ì´ê²ƒì´ MySQLì´ë‹¤ - ìš°ìž¬ë‚¨   
> SQLì€ ì²˜ìŒ ë°°ì›Œë³´ëŠ”ê±°ë¼ ê±±ì •í–ˆì—ˆëŠ”ë° ë‹¤í–‰ížˆ Pandasë¥¼ ì‚¬ìš©í•œ ê²½í—˜ì´ ìžˆì–´ì„œ ê·¸ëŸ°ì§€ ìˆ˜ì—… ì§„ë„ëŠ” ë‚˜ë¦„ ìž˜ ë”°ë¼ê°€ê³  ìžˆëŠ” ê²ƒ ê°™ë‹¤.

# MySQL WorkBench - SQL ì‹¤í–‰ ë‹¨ì¶•í‚¤
> ë§¤ ë²ˆ ì¿¼ë¦¬ ì‹¤í–‰ì‹œ âš¡ë²ˆê°œ ëª¨ì–‘âš¡ì„ í´ë¦­í•˜ëŠ”ê²Œ ë²ˆê±°ë¡œì›Œì„œ êµ¬ê¸€ë§ì„ í†µí•´ ë‹¨ì¶•í‚¤ë¥¼ ì•Œì•„ë³´ì•˜ë‹¤.

## 1ê°œì˜ SQLë¬¸ ì‹¤í–‰
- ì»¤ì„œê°€ ìžˆëŠ” 1ê°œì˜ SQLë¬¸ì„ ì‹¤í–‰ ì‹œí‚¤ë ¤ë©´ [Ctrl+Enter]

## ì—¬ëŸ¬ê°œ(ë‹¤ì¤‘) SQLë¬¸ ì‹¤í–‰
- ì‹¤í–‰í•˜ê³ ìž í•˜ëŠ” SQLë¬¸ë“¤ì˜ ì˜ì—­ì„ ë“œëž˜ê·¸í•œ í›„ [Ctrl+Shift+Enter]

## SQLì°½ì˜ ì „ì²´ ëª¨ë‘ ì‹¤í–‰
- SQLì°½ì˜ ëª¨ë“  SQLë¬¸ì„ ì‹¤í–‰ì‹œí‚¤ë ¤ë©´ ì•„ë¬´ê²ƒë„ ì„ íƒí•˜ì§€ ì•Šê³  [Ctrl+Shift+Enter]

# ì˜¤ëŠ˜ í•™ìŠµí•œ ë‚´ìš© ì •ë¦¬ ðŸ“–

## ë°ì´í„° ì¡°íšŒ
```sql
-- í…Œì´ë¸” ì „ì²´ ì¶œë ¥
SELECT * FROM emp;

-- í…Œì´ë¸”ì˜ íŠ¹ì • ì»¬ëŸ¼ë§Œ ì¶œë ¥
SELECT empno,empname,salary FROM emp;

-- í˜„ìž¬ ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸” ëª©ë¡
SHOW TABLES;

-- í˜„ìž¬ ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë“  í…Œì´ë¸” ì •ë³´
SHOW TABLE STATUS;

-- ìŠ¤í‚¤ë§ˆ( í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…ê³¼ ì»¬ëŸ¼ë“¤ì˜ ì œì•½ì¡°ê±´ ì •ë³´ )ë¥¼ ë³¼ ìˆ˜ ìžˆëŠ” ëª…ë ¹ì–´
DESC emp;

-- asëŠ” ì»¬ëŸ¼ëª…ì„ ë°”ê¾¸ëŠ” êµ¬ë¬¸, ì»¬ëŸ¼ì— ë³„ì¹­(Alias)ì„ ë¶™ì´ëŠ” ê²ƒ
SELECT empno, empname, salary/12 AS msal FROM emp;
```

## ë³„ì¹­ ( Alias )
- asëŠ” ì»¬ëŸ¼ëª…ì„ ë°”ê¾¸ëŠ” êµ¬ë¬¸
```sql
SELECT empno, empname, salary/12 AS msal FROM emp;
```
# WHEREì ˆì˜ ê¸°ë³¸ ì¡°ê±´ í‘œí˜„ì‹
- ANDì™€ ORì„ í†µí•´ ì—¬ëŸ¬ ì¡°ê±´ì„ ê±¸ ìˆ˜ ìžˆë‹¤.
  - AND: ë‘ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ê²°ê³¼
  - OR: ë‘ ì¡°ê±´ ì¤‘ í•œ ì¡°ê±´ì„ ë§Œì¡±í•˜ê±°ë‚˜ ë‘ ì¡°ê±´ì„ ë‹¤ ë§Œì¡±í•˜ëŠ” ê²°ê³¼

## ANDì¡°ê±´
```sql
SELECT * FROM usertbl
WHERE mobile1=011
AND birthYear > 1970
AND height > 180;
```

## ORì¡°ê±´
```sql
SELECT * FROM usertbl
WHERE mobile1=011
OR birthYear > 1970
AND height > 180;
```

# BETWEEN êµ¬ë¬¸
- ë‘ ê°’ì˜ ë²”ìœ„ì— í•´ë‹¹í•˜ëŠ” í–‰ì„ ì¶œë ¥í•  ë•Œ ì‚¬ìš©í•œë‹¤. a ì´ìƒ b ì´í•˜ì˜ ê°’ì„ ì¡°íšŒí•˜ë¼ëŠ” ì˜ë¯¸ë¡œ >=ì™€ <= ì—°ì‚°ìžë¥¼ í•¨ê»˜ ì‚¬ìš©í•œ ê²ƒê³¼ ê°™ë‹¤.

```sql
SELECT * FROM usertbl
WHERE height BETWEEN 180 AND 183;
```

# íŠ¹ì • ë°ì´í„° ì¡°íšŒ
- í…Œì´ë¸”ì˜ íŠ¹ì • ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•
- `SELECT` * `FROM` í…Œì´ë¸” ì´ë¦„ `WHERE` ì¡°ê±´ì‹
```sql
-- íšŒì› ì¤‘ì— ì§€ì—­ì´ ê²½ë‚¨, ì „ë‚¨, ê²½ë¶ì¸ íšŒì›ì„ ì¡°íšŒí•˜ì‹œì˜¤
SELECT * FROM usertbl
WHERE addr = 'ê²½ë‚¨' OR addr = 'ì „ë‚¨' OR addr = 'ê²½ë¶';

SELECT * FROM usertbl
WHERE addr IN ('ê²½ë‚¨','ì „ë¶','ê²½ë¶');

-- ì£¼ì†Œê°€ ê²½ë‚¨, ì „ë¶, ê²½ë¶ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì§€ì—­ì˜ íšŒì›ì„ ì¡°íšŒí•˜ì‹œì˜¤
SELECT * FROM usertbl
WHERE addr NOT IN ('ê²½ë‚¨','ì „ë¶','ê²½ë¶');
```

# LIKE %_ ë¬¸ìžì—´ íŒ¨í„´ ë§¤ì¹­ ì¡°ê±´ 
```sql
SELECT * FROM usertbl
WHERE name LIKE '%ì¡°%'; -- ì´ë¦„ì´ 'ì¡°'ë¡œ ì‹œìž‘í•˜ëŠ” ì‚¬ëžŒ
-- WHERE name LIKE '%ì¡°%'; -- ì´ë¦„ì— 'ì¡°'ë¼ëŠ” ë‹¨ì–´ê°€ í¬í•¨ë˜ì–´ ìžˆëŠ” ì‚¬ëžŒ

SELECT * FROM usertbl
WHERE addr LIKE '_ë¶'; -- ë‘ìŒì ˆì´ë©° ë§ˆì§€ë§‰ ìŒì ˆì´ ë¶ì¸ ë‹¨ì–´

SELECT * FROM usertbl
WHERE name LIKE '_ìš©%'; -- ìš©ì„ í¬í•¨í•œ ë‘ìŒì ˆì´ë©° ìš©ë’¤ì—ëŠ” ì•„ë¬´ë‹¨ì–´ ê°€ëŠ¥
```
# í…Œì´ë¸” ì¡°íšŒ ì •ë ¬
- í…Œì´ë¸”ì—ì„œ ë°ì´í„° ì¡°íšŒ ì‹œ, ORDER BYë¥¼ ì¶”ê°€í•˜ì—¬ ì§€ì •ëœ ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ í•  ìˆ˜ ìžˆë‹¤.
```sql
SELECT * FROM usertbl
ORDER BY height DESC; -- heightë¥¼ ìˆœì„œëŒ€ë¡œ ì¶œë ¥ ASC:ì˜¤ë¦„ì°¨ìˆœ DESC: ë‚´ë¦¼ì°¨ìˆœ

SELECT * FROM usertbl
ORDER BY height DESC, birthYear DESC;

-- ì„œìš¸ê³¼ ê²½ìœ¼ë¡œ ì‹œìž‘í•˜ëŠ” ì§€ì—­ì˜ íšŒì›ì„ ì¡°íšŒí•˜ì‹œì˜¤
-- ë‹¨ ìµœê·¼ì— ê°€ìž…í•œ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì‹œì˜¤
SELECT * FROM usertbl
WHERE addr='ì„œìš¸' OR addr LIKE 'ê²½%'
ORDER BY mDATE DESC;

SELECT * FROM usertbl
ORDER BY height DESC, birthYear DESC
LIMIT 5,3;
```

```sql
-- íšŒì›ì´ êµ¬ë§¤í•œ ì œí’ˆì˜ ì´ ê¸ˆì•¡ì„ ì¡°íšŒí•˜ì‹œì˜¤
-- userID(íšŒì›ID), prodName(ì œí’ˆëª…), total(ì´ê¸ˆì•¡ price * amount)
-- ì´ê¸ˆì•¡ì´ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬

-- ì˜¤ë‹µ
/*
SELECT * FROM buytbl
ORDER BY price * amount DESC;
*/
-- ì •ë‹µ
SELECT userID, prodName, price * amount AS total FROM buytbl
ORDER BY total DESC;
```

```sql
-- sqldb

-- mobile1ì´ ì¡´ìž¬í•˜ëŠ” íšŒì›ë§Œ ì¡°íšŒí•˜ì‹œì˜¤.
SELECT * FROM usertbl
WHERE mobile1 IS NULL;
-- WHERE mobile1 IS NOT NULL;

-- mobile1ê³¼ mobile2ê°€ ì—†ìœ¼ë©´ ì¡°íšŒ ì‹œ 000,0000000ìœ¼ë¡œ ì¡°íšŒí•˜ì‹œì˜¤
SELECT userID,name, IFnull(mobile1, '000'),
IFNULL(mobile2, '0000000') FROM usertbl;

-- ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ì˜ ë°ì´í„°ë¥¼ ë¬¶ì„ ìˆ˜ ìžˆë‹¤.
SELECT name, CONCAT(mobile1, mobile2) FROM usertbl;
```


# ìˆ«ìž ì—°ì‚°

```sql
-- ë‚ ì§œ 2010:10:10
SELECT name,DATE_FORMAT(mDate,'%Y/%m/%d') AS mDate FROM usertbl
WHERE DATE_FORMAT(mDate,'%Y:%m:%d') = '2010:10:10';

-- ê°€ìž… ì¼ì´ 2010-01 ë¶€í„° 2013-12ê¹Œì§€ì˜ íšŒì›ì„ ì¡°íšŒí•˜ì‹œì˜¤
SELECT * FROM usertbl
WHERE DATE_FORMAT(mDate,'%Y-%m') BETWEEN '2010-10' AND '2013-12';

-- ê°€ìž… ì›”ì´ 05ì›”, 10ì›”ì¸ íšŒì›ì„ ì¡°íšŒí•˜ì‹œì˜¤.
SELECT * FROM usertbl
WHERE MONTH(mDate) IN ('05','10');
```
# ë‚ ì§œ
- ë‚ ì§œê°€ ë‚˜ì˜¤ë©´ ì¢€ ì‹ ê²½ì¨ì•¼ í•œë‹¤. date_format()ì´ë‚˜ month()ê°™ì€ ê±¸ë¡œ ê°€ê³µí•´ì„œ ì²˜ë¦¬í•˜ëŠ”ê²Œ í•„ìš”
- í•´ë‹¹ì¡°ê±´ì´ë©´ ê·¸ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì„œ ì¶œë ¥
```sql
SELECT name,
( CASE 
      WHEN mobile1 = '011' THEN 'SKT'
      WHEN mobile1 = '019' THEN 'LGT'
      WHEN mobile1 IS NULL THEN 'NULL'
      ELSE 'NONE'
 END) AS mobile FROM usertbl;
 
 
 SELECT name,height,(CASE
  WHEN height >= 180 THEN 'H'
  WHEN height >= 170 THEN 'M'
  ELSE 'L'
 END ) AS GRADE FROM usertbl;
 ```

 ```sql
 -- êµ¬ë§¤í…Œì´ë¸”ì—ì„œ êµ¬ë§¤ê¸ˆì•¡ì˜ í•©ì‚°(price*amount)ê¸ˆì•¡ì´
 -- 808 ì´ìƒì´ë©´ GOLD, 100ì´ìƒì´ë©´ SILVER, ë‚˜ë¨¸ì§€ëŠ” BRONZE
 -- ë¡œ ì¶œë ¥í•˜ì‹œì˜¤
 -- userID, total, grade

 SELECT userID, price*amount AS total, (
  CASE  -- ALIASëŠ” ì¼€ì´ìŠ¤ë¬¸ ì•ˆì— ì“¸ ìˆ˜ ì—†ë‹¤. price*amountëŒ€ì‹  totalì„ ì“¸ ìˆ˜ ì—†ë‹¤.
   WHEN price*amount >= 800 THEN 'GOLD'
   WHEN price*amount >= 100 THEN 'SILVER'
   ELSE 'BRONZE'
  END
 ) AS grade FROM buytbl;
 -- ORDER BY grade DESC; ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì •ë ¬ì´ ëœë‹¤.
 ```


```sql
-- sqldb
-- ìš°ë¦¬ íšŒì›ë“¤ì˜ ì§€ì—­ì„ ì¡°íšŒí•˜ì‹œì˜¤
SELECT addr FROM usertbl;  -- ì¤‘ë³µì´ ìžˆìŒ
SELECT DISTINCT(addr) FROM usertbl;  -- ì¤‘ë³µì´ ì œê±°ë¨
```
```sql
-- ê·¸ë£¹í•‘í• ë ¤ëŠ”ì»¬ëŸ¼ì„ ì¡°íšŒ
SELECT userID, SUM(price*amount) AS total FROM buytbl
GROUP BY userID
HAVING total >= 1000; -- group byëŠ” ì¡°ê±´ì„ ì¤„ ë•Œ havingì„ ì“´ë‹¤
-- HAVING SUM(price) >= 1000; 

SELECT * FROM buytbl;

-- userID ë³„ êµ¬ë§¤í•œ ê°œìˆ˜ì˜ í‰ê· ì„ êµ¬í•˜ì‹œì˜¤
SELECT userID, AVG(amount) AS avg FROM buytbl
GROUP BY userID;

-- userID ë³„ êµ¬ë§¤í•œ ìƒí’ˆì˜ ê°€ì§€ìˆ˜ë¥¼ êµ¬í•˜ì‹œì˜¤
SELECT userID, COUNT(DISTINCT prodName) FROM buytbl
GROUP BY userID;

-- userID ë³„ êµ¬ë§¤í•œ ì¹´í…Œê³ ë¦¬ì˜ ê°€ì§€ìˆ˜ë¥¼ êµ¬í•˜ì‹œì˜¤ fromì ˆë‹¤ìŒì— ì„œë¸Œì¿¼ë¦¬ ë„£ì„ë•ŒëŠ” AS ê¼­ ë„£ê³  ì‚¬ìš©
SELECT userID, COUNT(DISTINCT groupName) FROM buytbl
GROUP BY userID;

-- ë°”ê¾¼ ì¿¼ë¦¬
SELECT bt.userID, COUNT(DISTINCT bt.groupName) FROM (
SELECT userID, IFNULL(groupName, 'ì‹ ë°œ') AS groupName FROM buytbl
) bt
GROUP BY userID;


SELECT * FROM usertbl;

-- ì§€ì—­ë³„ í‚¤ ê°’ì˜ í‰ê· , ìµœëŒ€, ìµœì†Œ, í•©ê³„ë¥¼ êµ¬í•˜ì‹œì˜¤
SELECT addr,AVG(height), MAX(height), MIN(height), SUM(height) FROM usertbl
GROUP BY addr
HAVING MIN(height) >= 170
AND SUM(height) > 200;


-- ê°€ìž… ì›” ë³„ íšŒì›ì˜ í‰ê·  í‚¤ë¥¼ êµ¬í•˜ì‹œì˜¤
SELECT MONTH(mDate), AVG(height) FROM usertbl
GROUP BY MONTH(mDate);

SELECT addr, MONTH(mDate), AVG(height) FROM usertbl
GROUP BY addr, MONTH(mDate)
ORDER BY addr;

-- ë…„ ë³„ ì›” ë³„ ê°€ìž…íšŒì›ì˜ í‚¤ í‰ê· ì„ êµ¬í•˜ì‹œì˜¤
SELECT YEAR(mDate), MONTH(mDate), AVG(height) FROM usertbl
GROUP BY YEAR(mDate), MONTH(mDate)
ORDER BY YEAR(mDate);
```


```sql
-- emps
-- ì‚¬ì›ì •ë³´ë¥¼ ì¡°íšŒí•˜ì‹œì˜¤
-- empno, empname, salary, msal(ì›”ê¸‰, sal/12)
-- ì›”ê¸‰ì´ í° ìˆœìœ¼ë¡œ ì •ë ¬
SELECT empno, empname, salary, salary/12 AS msal FROM emp
ORDER BY msal DESC;

-- deptnoê°€ 10,30ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¶€ì„œ ì§ì›ë“¤ì˜ ì—°ë´‰ì´ 3000~4000ì¸ 
-- ì§ì› ì •ë³´ë¥¼ ì¡°íšŒí•˜ì‹œì˜¤ ì—°ë´‰ì´ í°ìˆœìœ¼ë¡œ ì •ë ¬
SELECT * FROM emp
WHERE deptno NOT IN (10, 30)
AND salary BETWEEN 3000 AND 4000
-- AND salary >= 3000 AND salary <= 4000
ORDER BY salary DESC;

-- ìž…ì‚¬ ë…„ì´ ì˜¤ëž˜ëœ ìˆœìœ¼ë¡œ ì¡°íšŒí•˜ì‹œì˜¤
SELECT * FROM emp
ORDER BY hdate ASC
LIMIT 5;        -- ì´ì¤‘ì—ì„œ ì˜¤ëž˜ëœ 5ëª…ë§Œ ì¶œë ¥

-- ì´ì˜ì—…ì˜ managerì™€ ê°™ì€ managerì¸ ì§ì›ë“¤ì„ ì¡°íšŒí•˜ì‹œì˜¤
SELECT * FROM emp
WHERE manager = (SELECT manager FROM emp
WHERE empname='ì´ì˜ì—…');

-- ì´ì˜ì—…ê³¼ í™ì •êµ­ì˜ managerì™€ ê°™ì€ managerì¸ ì§ì›ë“¤ì„ ì¡°íšŒí•˜ì‹œì˜¤
-- ì„œë¸Œì¿¼ë¦¬ë¬¸(ì¿¼ë¦¬ì•ˆì— ì¿¼ë¦¬ê°€ ë“¤ì–´ê°€ëŠ” ê²ƒ)
SELECT manager FROM emp
WHERE manager IN (SELECT manager FROM emp
WHERE empname='ì´ì˜ì—…'
OR empname='í™ì •êµ­');
```


## REFERENCE
- https://dwbutter.com/
- https://ngg3319.tistory.com/123